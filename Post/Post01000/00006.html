<!DOCTYPE html>
<html>
  
<head>
    <meta charset="UTF-8">
    <title> 밀러-라빈 소수판별법 </title>
    <link rel="stylesheet" href="/style.css">
</head>

<body>
    <div id = 'wrap'>  
    <div class="container">
        <header>
            <script type="text/javascript" src="/headerWrite.js"></script>
        </header>
    </div>
    <section>
    
    <div id = "postTitle"> 밀러-라빈 소수 판병법 </div>
      
    <hr>
      
    <p>
      
    가장 기초적인 소수 판별법은 <a href="/Post/Post01000/00001.html"> $2$부터 $\sqrt{N}$까지 나누어보는 방법 </a>을 쓰곤 했습니다. <br>

    더더욱 빠르고, 그러면서도 정확한 소수 판별법을 위해서 정수론의 두가지 정리를 이용해줍니다. <br>

    <hr>

    <blockquote>
        <a href="/Post/Post01000/00005.html"> <b>페르마의 소정리</b> </a> <br>
        1. 모든 소수 $p$와 모든 자연수 $a$에 대하여 $a^{p} \equiv a \pmod{p}$이다. <br>
        2. $p$와 $a$가 <b>서로소</b>이면 $a^{p-1} \equiv 1 \pmod{p}$이다.
    </blockquote>

    페르마의 소정리는 아주 간결하고 꽤나 강력하지만, 완전하진 못합니다. <br>
    
    모든 소수 $p$가 이를 만족하지만, 가끔씩 어떤 자연수 $a$에 대하여 $a^{N-1} \equiv 1 \pmod{N}$인 <b>합성수</b> $N$이 존재하기도 합니다. <br>

    예를 들어, $341$같은 Poulet Number는 $2^{340} \equiv 1 \pmod{341}$이지만 $341 = 11 \times 31$입니다. <br>

    게다가 <b>모든 자연수</b> $a$에 대하여 $a^{N} \equiv a \pmod{N}$가 되는 합성수 $N$ (카마이클 수)도 있으므로 페르마의 소정리 만으로는 부족합니다. <br>

    <hr>

    <blockquote>
        보조정리<br>
        소수 $p$에 대하여 $x^{2} \equiv 1 \pmod{p}$이면 $x \equiv 1 \pmod{p}$이거나 $x \equiv -1 \pmod{p}$이다.
    </blockquote>

    증명은 유클리드의 보조정리에 의해 쉽게 할 수 있습니다. <br>

    <blockquote>
        유클리드의 보조정리<br>
        소수 $p$에 대하여 $ab \equiv 0 \pmod{p}$이면 $a \equiv 0 \pmod{p}$이거나 $b \equiv 0 \pmod{p}$이다.
    </blockquote>

    $x^{2} \equiv 1 \pmod{p}$에서 $x^{2}-1 \equiv 0 \pmod{p}$이고, $(x - 1)(x + 1) \equiv 0 \pmod{p}$이므로 <br>

    $x \equiv 1 \pmod{p}$이거나 $x \equiv -1 \pmod{p}$임을 쉽게 알 수 있습니다. <br>
      
    <hr>
      
    페르마의 소정리와 보조정리를 사용해주기 위해서 $N - 1$을 $N - 1 = 2^{s} \times d$로 쪼개줍니다. <br>
      
    이때, $s$는 자연수, $d$는 <b>홀수</b>입니다. <br>
      
    (즉, $d$는 $N−1$을 $2$로 나눌 수 있을 때까지 계속 나누고 남은 수, $s$는 $N−1$을 $2$로 나눈 횟수) <br>
      
    $2 \leq a \leq N-1$인 적당한 정수 $a$ (보통 2부터...)를 선택해 줍니다. (어떤 $a$값을 선택할 지는 후술) <br>
      
    $a^{d} \pmod{N}$의 값을 구해줍니다. 이후 $a^{d} \pmod{N}$의 값에 따른 두가지 경우로 나뉩니다. <br>
      
    <h3> 1. $a^{d} \equiv -1 \pmod{N}$ 이거나 $a^{d} \equiv 1 \pmod{N}$인 경우 </h3> <br>

    이 경우엔 $a^{N-1} \equiv a^{d \times 2^{s}} \equiv { \left(a^{d} \right)}^{2^{s}} \equiv {(-1)}^{2^{s}} \equiv 1 \pmod{N}$ 이거나, ($-1$의 짝수 거듭 제곱은 $1$) <br>
    
    ${ \left(a^{d} \right)}^{2^{s}} \equiv {(1)}^{2^{s}} \equiv 1 \pmod{N}$ 이므로 페르마의 소정리를 통과합니다. 따라서 "아마도 소수" 라고 볼 수 있습니다. <br>
      
    <h3> 2. $a^{d} \not\equiv \pm1 \pmod{N}$ 인 경우 </h3> <br>
      
    이 경우에는 또 3가지 경우로 나누어집니다. $a^{d} \equiv b \pmod{N}$ 라고 한다면 <br>
      
    <h4> 2 - 1. $b^{2} \equiv -1 \pmod{N}$ 일 경우 </h4> <br>
      
    $a^{d \times 2} \equiv b^{2} \pmod{N}$에서 $a^{N-1} \equiv a^{d \times 2^{s}} \equiv { \left(a^{d \times 2} \right)}^{2^{s-1}} \equiv {(-1)}^{2^{s-1}} \equiv 1 \pmod{N}$ 이므로, <br>
      
    페르마의 소정리를 통과합니다. 따라서 "아마도 소수" 라고 볼 수 있습니다. <br>
      
    <h4> 2 - 2. $b^{2} \equiv 1 \pmod{N}$ 일 경우 </h4> <br>
      
    보조정리에 의해, $N$이 소수일 때는 $b^{2} \equiv 1 \pmod{N}$이면 $b \equiv 1 \pmod{N}$이거나 $b \equiv -1 \pmod{N}$여야 하지만, 2번의 전제가 $b \not\equiv \pm 1 \pmod{N}$인 경우였으므로, <br>
      
    이 경우는 $N$이 <b>확실히</b> 합성수라는 것을 말해줍니다. ("아마도 소수"같은 것이 아닌 <b>확실히</b> 합성수 입니다. <br>
      
    <h4> 2 - 3. $b^{2} \not\equiv \pm1 \pmod{N}$ 일 경우 </h4> <br>

    이 경우에도 3가지로 나누어서, $b^{2} = c$라 하고 $c^{2} \pmod{N}$ 의 값을 구해서 2 - 1, 2 - 2, 2 - 3 의 단계를 반복합니다. <br>

    만약에 이렇게 계속 $b^{2}, b^{4}, b^{8} \cdots$로 올라가면서도 끝끝내 $a^{d \times 2^{s-1}} \not\equiv \pm1 \pmod{N}$이라는 결과까지 가면, $N$은 <b>확실히</b> 합성수입니다. <br>
      
    $a^{d \times 2^{s-1}} \pmod{N}$의 값까지 계산하는 단계까지 왔으면 $a^{d \times 2^{s}} \pmod{N}$의 값을 계산하지 않아도 됩니다. <br>
      
    $a^{d \times 2^{s}} \equiv -1 \pmod{N}$이면 페르마의 소정리에 의해서 $N$이 소수가 아니고, <br>
      
    $a^{d \times 2^{s}} \equiv 1 \pmod{N}$이면 페르마의 소정리에 의해서는 소수일 수 있지만, 2-2에서 설명한 논리대로 확실히 합성수이고, <br>
      
    그 외의 경우에는 페르마의 소정리에 의해서 당연하게 소수가 아니게 됩니다.
      
    <hr>
      
    $a$값은 어떻게 선택해야할까요? <br>
      
    밀러가 처음 발표한 소수판별법은, 일반화 리만가설이 맞다는 가정하에 $2 \leq a \leq 2 {\left(\ln{N}\right)}^2$인 모든 $a$에 대해서만 검사하면 된다고 했습니다. <br>
      
    라빈은 리만가설을 제외하고, 적당히 $2 \leq a \leq N - 1$인 $a$를 랜덤으로 128개 정도 뽑아서 판별하면 대충 소수가 아니겠냐는 확률적 알고리즘으로 바꿉니다. <br>
      
    (어떤 $a$이든 위 판별법이 틀릴 확률이 아무리 높아도 $\frac{1}{4}$보다는 낮다는게 알려져있고, 128번 반복하면 $\frac{1}{4^{128}} = \frac{1}{2^{256}}$이라는 확률이 나와 거의 일어나지 않을 일이기 때문) <br>
      
    그러나 $N$이 아주 크지 않다면, $a$의 갯수를 획기적으로 줄일 수 있다는게 <b>노가다</b>로 알려져 있습니다. <br>
      
    더 빠른 소수 판별법을 위해 직접 노가다로 고생하신 4분 Pomerance, Selfridge, Wagstaff, Jaeschke 님에게 경의를 표하면서 결과를 감상하도록 해봅니다. <br>
      
    <blockquote>
        $N < 2,047$이면, $a = 2$일 때만 검사해도 충분합니다. <br>
        $N < 1,373,653$이면, $a = 2$, $3$일 때 두 번만 검사해도 충분합니다. <br>
        $N < 25,326,001$이면, $a = 2$, $3$, $5$일 때 세 번만 검사해도 충분합니다. <br>
        $N < 3,215,031,751$이면, $a = 2$, $3$, $5$, $7$일 때만 검사해도 충분합니다. <br>
        ($2^{31} < 3,215,031,751$이므로, int형 범위에서는 $a = 2$, $3$, $5$, $7$일 때만 검사해도 충분합니다.) <br>
        $N < 2,152,302,898,747$이면, $a = 2$, $3$, $5$, $7$, $11$일 때만 검사해도 충분합니다. <br>
        $N < 3,474,749,660,383$이면, $a = 2$, $3$, $5$, $7$, $11$, $13$일 때만 검사해도 충분합니다. <br>
        $N < 341,550,071,728,321$이면, $a = 2$, $3$, $5$, $7$, $11$, $13$, $17$일 때만 검사해도 충분합니다. <br>
    </blockquote>
      
    Feitsma, Galway, Jiang, Deng 이 4분이 결과를 더더욱 확장시켜주었습니다.
      
    <blockquote>
        $N < 3,825,123,056,546,413,051$이면, $a = 2$, $3$, $5$, $7$, $11$, $13$, $17$, $19$, $23$일 때만 검사해도 충분합니다. <br>
        $N < 18,446,744,073,709,551,616 = 2^{64}$이면, $a = 2$, $3$, $5$, $7$, $11$, $13$, $17$, $19$, $23$, $29$, $31$, $37$일 때만 검사해도 충분합니다. <br>
        (즉, unsigned long long 범위에서도 12번만 검사해도 충분합니다.) <br>
    </blockquote>
    
    </p>
      
    </section>
    <aside>
        <script type="text/javascript" src="/asideWrite.js"></script>
    </aside>
    
    <footer>
        <script type="text/javascript" src="/footerWrite.js"></script>
    </footer>
    
    </div> <!-- wrap -->
  
    <script type="text/javascript" src="/LaTexWrite.js"></script>

</body>
</html>
